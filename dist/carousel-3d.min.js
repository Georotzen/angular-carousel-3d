/*!
 * angular-directive-boilerplate
 * 
 * Version: 0.0.8 - 2015-10-05T01:21:05.338Z
 * License: MIT
 */
/*!
 * angular-carousel-3d
 * 
 * Version: 0.0.4
 * License: MIT
 */
!function(){"use strict";function e(e,t){function i(t,i){this.imageLocations=t,this.imageProp=i,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=e.defer(),this.promise=this.deferred.promise}function s(){return this.state!==this.states.PENDING}function r(){return this.state===this.states.REJECTED}function n(){return this.state===this.states.RESOLVED}function l(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var e=0;e<this.imageCount;e++)this.loadImageLocation(this.imageLocations[e][this.imageProp]);return this.promise}function o(e){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(e))}function a(e){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:e}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))}function d(e){var i=this,s=new Image;s.onload=function(e){t.$apply(function(){i.handleImageLoad(e.target.src),i=s=e=null})},s.onerror=function(e){t.$apply(function(){i.handleImageError(e.target.src),i=s=e=null})},s.src=e}i.preloadImages=function(e,t){var s=new i(e,t);return s.load()};var c={constructor:i,isInitiated:s,isRejected:r,isResolved:n,load:l,handleImageError:o,handleImageLoad:a,loadImageLocation:d};return angular.extend(i.prototype,c),i}function t(e,t,i,s,r,n){function l(){I=angular.element(t[0].querySelector(".carousel-3d")),v={slides:[],rightItems:[],leftItems:[],rightOutItem:null,leftOutItem:null,visible:3,perspective:35,animationSpeed:500,startSlide:0,dir:"ltr",total:0,slide:0,current:null,width:480,height:360,border:10,space:"auto",topSpace:"auto",lock:!1},angular.extend(v,p.carousel3dOptions);var e=I.children();if(!e.length>0)return!1;I.css({width:v.width+v.border+"px",height:v.height+v.border+"px"});for(var i=0;i<e.length;i++){var s=e[i],r=angular.element(s),n={outerwidth:v.width+v.border,outerheight:v.height+v.border,width:v.width,height:v.height,index:i},l={visibility:"hidden","border-width":v.border+"px"};r.attr(n),r.css(l),v.slides.push(r)}v.total=v.slides.length,v.startSlide=v.startSlide<0||v.startSlide>v.total?0:v.startSlide,v.slide=v.startSlide,v.currentSlide=v.slides[v.slide],v.visible=v.visible>v.total?v.total:v.visible,v.visible=2===v.visible?v.visible%2?v.visible:v.visible:v.visible%2?v.visible:v.visible-1,m()}function o(e){v.slide!=e?u(e):p.onSelectedClick&&p.onSelectedClick({index:v.slide})}function a(e,t,i){v.slide==v.total-1,v.slide=0>e||e>v.total-1?0:e,v.slide==v.total-1,v.currentSlide=v.slides[v.slide];for(var r=0;r<v.slides.length;r++)v.slides[r].removeClass("current");return v.lock=!0,m(!0,v.animationSpeed),s(function(){h()},v.animationSpeed),i?!1:!0}function d(e){return e=e?e:!1,!e&&v.lock?!1:(v.slide==v.total?a(0,!1,e):a(v.slide+1,!1,e),!1)}function c(e){return e=e?e:!1,!e&&v.lock?!1:(0==v.slide?a(v.total-1,!1,e):a(v.slide-1,!1,e),!1)}function u(e){var t=e==v.total-1&&0==v.slide?-1:e-v.slide;v.slide==v.total-1&&0==e&&(t=1);for(var i=0>t?-t:t,r=0,n=0;i>n;n++){var l=1==i?0:r;s(function(){0>t?c(i):d(i)},l),r+=v.animationSpeed/i}}function h(){v.lock=!1,p.onSlideChange&&p.onSlideChange({index:v.slide})}function g(e,t,i,s){var r=parseInt("auto"==v.space?(t+1)*(parseInt(angular.element(e).attr("width"))/1.5):(t+1)*v.space),n=s?"translateX("+r+"px) translateZ(-"+(250+110*(t+1))+"px) rotateY(-"+v.perspective+"deg)":"translateX(-"+r+"px) translateZ(-"+(250+110*(t+1))+"px) rotateY("+v.perspective+"deg)",l="0%",o="auto"==v.topSpace?"none":parseInt((t+1)*v.space),a="none",d="none",c="visible";return{"-webkit-transform":n,"-moz-transform":n,"-o-transform":n,"-ms-transform":n,transform:n,left:l,top:o,width:a,height:d,zIndex:i,overflow:c}}function m(e,t){var i=Math.floor(v.visible/2)+1;v.leftItems=[],v.rightItems=[];for(var s=1;i>s;s++){var r="ltr"==v.dir?(v.slide+s)%v.total:(v.slide-s)%v.total;v.leftItems.push(f(r));var n="ltr"==v.dir?(v.slide-s)%v.total:(v.slide+s)%v.total;v.rightItems.push(f(n))}v.leftOutItem=f(v.slide-i),v.rightOutItem=f(v.total-v.slide-i<=0?-parseInt(v.total-v.slide-i):v.slide+i);var l=v.leftOutItem,o=v.rightOutItem;"ltr"==v.dir&&(v.leftOutItem=o,v.rightOutItem=l);var a,d="auto"==v.topSpace?v.height/2-parseInt(v.currentSlide.attr("outerheight"))/2:0,c=v.width/2-parseInt(v.currentSlide.attr("outerwidth"))/2,u=(v.width/4,999),h={},m=t?t/1e3:v.animationSpeed/1e3;if(e)for(var I=0;I<v.slides.length;I++)v.slides[I].css({"-webkit-transition":"all "+m+"s ","-moz-transition":"all "+m+"s ","-o-transition":"all "+m+"s ","-ms-transition":"all "+m+"s ",transition:"all "+m+"s "});for(var S=0;S<v.slides.length;S++)v.slides[S].css({position:"absolute",opacity:0,visibility:"hidden",overflow:"hidden",top:d+"px"});v.currentSlide.addClass("current").css({zIndex:u,opacity:1,visibility:"visible"}),v.currentSlide.css({"-webkit-transform":"none","-moz-transform":"none","-o-transform":"none","-ms-transform":"none",transform:"none",left:c+"px",top:d+"px",width:v.currentSlide.attr("width")+"px",height:v.currentSlide.attr("height")+"px"});for(var b=0;b<v.rightItems.length;b++)a=v.rightItems[b],u-=b+1,h=g(a,b,u,!0),a.css(h).css({opacity:1,visibility:"visible",zIndex:u});for(var w=0;w<v.leftItems.length;w++)a=v.leftItems[w],u-=w+1,h=g(a,w,u),a.css(h).css({opacity:1,visibility:"visible",zIndex:u});if(v.total>v.visible){var C=g(v.rightOutItem,v.leftItems.length-.5,v.leftItems.length-1,!0),x=g(v.leftOutItem,v.leftItems.length-.5,v.leftItems.length-1);v.rightOutItem.css(C),v.leftOutItem.css(x)}p.isRendered=!0}function f(e){return e>=0?v.slides[e]:v.slides[v.slides.length+e]}var p=this;p.isLoading=!0,p.isSuccessful=!1,p.isRendered=!1,p.percentLoaded=0,p.init=l,p.slideClicked=o,p.goPrev=c,p.goNext=d;var v=null,I=null;v={slides:[],rightItems:[],leftItems:[],rightOutItem:null,leftOutItem:null,visible:3,perspective:35,animationSpeed:500,startSlide:0,dir:"ltr",total:0,slide:0,current:null,width:480,height:360,border:10,space:"auto",topSpace:"auto",lock:!1},angular.extend(v,p.carousel3dOptions),t.css({height:v.height+v.border+"px"}),e.$watch("[vm.ngModel, vm.carousel3dOptions]",function(){n.preloadImages(p.ngModel,p.carousel3dSourceProp).then(function(e){p.isLoading=!1,p.isSuccessful=!0,s(function(){l()})},function(e){p.isLoading=!1,p.isSuccessful=!1},function(e){p.percentLoaded=e.percent})},!0)}function i(e){function t(e,t){return i}function i(e,t,i,s,r){}var s={restrict:"AE",template:'<div class="carousel-3d-container" ng-switch="vm.isLoading">   <div class="carousel-3d-loader" ng-switch-when="true">       <div class="carousel-3d-loader-circle" style="-webkit-transform:scale(0.75)"><div><div></div><div></div></div></div>       <div class="carousel-3d-loader-percentage">{{ vm.percentLoaded }}</div>   </div>   <div ng-switch-when="false" ng-switch="vm.isSuccessful">       <div class="carousel-3d" ng-switch-when="true" ng-show="vm.isRendered">           <img ng-repeat="image in vm.ngModel track by $index" ng-src="{{image[vm.carousel3dSourceProp]}}" class="slide-3d" ng-click="vm.slideClicked($index)" ng-swipe-left="vm.goPrev()" ng-swipe-right="vm.goNext()">       </div>       <p ng-switch-when="false">There was a problem during load</p>   </div></div>',replace:!0,scope:{ngModel:"=",carousel3dSourceProp:"@",carousel3dOptions:"=",onSelectedClick:"&",onSlideChange:"&"},controller:"Carousel3dController as vm",bindToController:!0,compile:t,link:i};return s}angular.module("angular-carousel-3d",["swipe"]).factory("PreloaderService",e).directive("carousel3d",i).controller("Carousel3dController",t),e.$inject=["$q","$rootScope"],t.$inject=["$scope","$element","$attrs","$timeout","$log","PreloaderService"],i.$inject=["$timeout"]}();